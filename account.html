<!DOCTYPE html> 
<html>
<meta charset="UTF-8">
<head> 
	<title>RambleOnline - Account</title> 
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
	<link rel="stylesheet" href="assets/css/jquery.mobile-1.2.0.min.css" />
	<link rel="stylesheet" href="assets/css/core.css" />
	<link rel="stylesheet" href="assets/css/menus.css" />
	<script type="text/javascript" charset="utf-8" src="assets/js/cordova-2.1.0.js"></script>
	<script src="assets/js/jquery-1.8.2.min.js"></script>
	<script src="assets/js/jquery-mobile-config.js"></script>
	<script src="assets/js/jquery.mobile-1.2.0.min.js"></script>
	<script src="assets/js/ajaxrequests.js"></script>
	
	<script src="assets/js/utilities.js"></script>

	<script src="assets/js/site.js"></script>

	<script type="text/javascript"
      src="http://maps.googleapis.com/maps/api/js?libraries=drawing&key=AIzaSyA1Oz8ZnLZ_mfkby54M_sdRzh8EAfAyRNA&sensor=true">
	</script>

	<script type="text/javascript" src="assets/js/oms.min.js"></script>

	<link rel="stylesheet" type="text/css" href="assets/css/map_core.css" />
	<script src="assets/js/map_core.js"></script>

	<script src="assets/js/jquery.nivo.slider.pack.js"></script>
	<link rel="stylesheet" href="assets/css/nivo-slider.css" />
	<link rel="stylesheet" href="assets/css/slider-themes/dark/dark.css" />

</head> 
<body>
	<div data-role="page" id="page-account">

		<script type="text/javascript">
		function sendAccFormData(){
			if(validateAccForm($('#accMessage'))){
				data = [$('#accCurPass').val(), $('#accPass').val(), $('#accEmail').val()]
				sendUpdateAccount(data, $('#accMessage'))
			}
		}
		function validateAccForm(messageTarget){
			var valid = true
			return validateField($('#accCurPass'), 'Current Password', messageTarget, 'password', true, 4, 40) &&
				validateField($('#accPass'), 'New Password', messageTarget, 'password', false, 4, 40) &&
				validateField($('#accEmail'), 'Email', messageTarget, 'email', false, 6, 254) &&
				fieldsEqual($('#accPass'), $('#accConfPass'), 'New Passwords', messageTarget) &&
				fieldsEqual($('#accEmail'), $('#accConfEmail'), 'Emails', messageTarget)
		}

		function sendDeleteAccountData(){
			if(validateDelAccForm($('#accDelMessage'))){
				sendDeleteAccount($('#accDelPass').val(), $('#accDelMessage'))
			}
		}

		function validateDelAccForm(messageTarget){
			return validateField($('#accDelPass'), 'Current Password', messageTarget, 'password', true, 4, 40)
		}
	</script>

		<div class="ramble_header">
		<div class="ramble_header_content">
			<div class="ramble_header_btngroup">
				<div data-role="controlgroup" data-type="horizontal" data-inline="true" data-mini="true">
					<a href="home.html" data-role="button">Dashboard</a>
					<a href="account.html" class="accountBtn" data-role="button">Account</a>
					<a href="login.html" class="loginLogout" data-role="button">Login</a>
				</div>
			</div>
			<div class="logo_ribbon"><a href="index.html"><img src="assets/images/rambleon-logo-header.png" /></a></div>
		</div>
		<div class="ramble_header_shadow"></div>
		
	</div><!-- /header -->

		<div data-role="content" class="ui-content homeContent">	

			<div class="general_routes_nav">
				<div data-role="controlgroup" data-type="horizontal" data-mini="true">
					<a href="home.html" data-role="button" data-icon="home" data-inline="true">Dashboard</a>
					<a href="byHand.html" data-role="button" data-icon="plus" data-inline="true">New Route</a>
					<a href="search.html" data-role="button" data-icon="search" data-inline="true">Search</a>
					<a href="myRoutes.html" data-role="button" data-icon="star" data-inline="true">My Routes</a>
					<a href="notesPhotos.html" data-role="button" data-icon="grid" data-inline="true">Notes &amp; Photos</a>
					<a href="stats.html" data-role="button" data-icon="info" data-inline="true">Stats</a>
				</div>
			</div>


			<div class="map_page_content">
				<h2>Account Management</h2>
				<div class="formcontainer f_left">
					<h3>Current User: <span id="settingsUserName"></span></h3>
					<script type="text/javascript">
						document.getElementById('settingsUserName').innerHTML = window.localStorage.getItem("user")
					</script>
					<form>
						Current Password: <input type="password" name="accCurPass" id="accCurPass" data-mini="true">
						<br /><hr />
						<p>Set a new email, new password, or both</p>
						New Password: <input type="password" name="accPass" id="accPass" data-mini="true">
						Confirm New Password: <input type="password" name="accConfPass" id="accConfPass" data-mini="true">
						New Email: <input type="email" name="accEmail" id="accEmail" data-mini="true">
						Confirm New Email: <input type="email" name="accConfEmail" id="accConfEmail" data-mini="true">
						<p id="accMessage" class="errorMessage">&nbsp;</p>
					</form>
					<div class="formbutton_holder">
						<a href="#" onClick="sendAccFormData()" data-theme="a" data-role="button" data-mini="true">Submit</a>
					</div>

				</div>

				<div class="formcontainer f_right">
					<h3>Delete Account</h3>
					<p>Deleting your account is <b>permanent</b>, and <i>everything</i> attached to your account will be deleted</p>
					<form>
						Current Password: <input type="password" name="accDelPass" id="accDelPass" data-mini="true">
						<p id="accDelMessage" class="errorMessage">&nbsp;</p>
					</form>
					<div class="formbutton_holder">
						<a href="#" onClick="sendDeleteAccountData()" data-theme="a" data-role="button" data-mini="true">Delete Account</a>
					</div>
				</div>
				<div class="clear"></div>

			</div>


		</div><!-- /content -->

		

		<div class="ramble_footer">
			<div class="ramble_footer_shadow"></div>
			<div class="footer_content"></div>
		</div>

	</div><!-- /page -->

</body>
</html>